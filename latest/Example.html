<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example · MIToS</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MIToS</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="Installation.html">Installation</a></li><li class="current"><a class="toctext" href="Example.html">Example</a><ul class="internal"><li><a class="toctext" href="#juliarepl-1">MIToS in the Julia REPL</a></li><li><a class="toctext" href="#commandline-1">MIToS in system command line</a></li></ul></li><li><span class="toctext">Modules</span><ul><li><a class="toctext" href="MSA.html">MSA</a></li><li><a class="toctext" href="Information.html">Information</a></li><li><a class="toctext" href="SIFTS.html">SIFTS</a></li><li><a class="toctext" href="PDB.html">PDB</a></li><li><a class="toctext" href="Pfam.html">Pfam</a></li></ul></li><li><a class="toctext" href="Scripts.html">Scripts</a></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="MSA_API.html">MSA</a></li><li><a class="toctext" href="Information_API.html">Information</a></li><li><a class="toctext" href="SIFTS_API.html">SIFTS</a></li><li><a class="toctext" href="PDB_API.html">PDB</a></li><li><a class="toctext" href="Pfam_API.html">Pfam</a></li><li><a class="toctext" href="Utils_API.html">Utils</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href="Example.html">Example</a></li></ul><a class="edit-page" href="https://github.com/diegozea/MIToS.jl/tree/0a30f8e0d608b960bed7e55c05fb77e161f3e967/docs/src/Example.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Example</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Example-1" href="#Example-1">Example</a></h1><p>In this simple demonstration, you will see how to calculate <strong>ZBLMIp</strong> (<strong>Z</strong> score of the corrected <strong>MIp</strong> using BLOSUM62 pseudo frequencies) for a <a href="http://pfam.xfam.org/">Pfam<img src="assets/external-link.png" alt/></a> MSA from the <a href="Example.html#juliarepl-1">Julia REPL</a> or using a <a href="Example.html#commandline-1">MIToS script in the system command line</a>.  </p><h2><a class="nav-anchor" id="juliarepl-1" href="#juliarepl-1">MIToS in the Julia REPL</a></h2><p>If you load the <code>Pfam</code> module from <code>MIToS</code>, you will get access to a set of functions that work with Pfam MSAs. In this case, we are going to use it for download a <a href="https://en.wikipedia.org/wiki/Stockholm_format">Stockholm<img src="assets/external-link.png" alt/></a> MSA from the Pfam website and read it into Julia.  </p><div></div><div><pre><code class="language-julia">using MIToS.Pfam
pfam_file = downloadpfam(&quot;PF10660&quot;)
msa = read(pfam_file, Stockholm, generatemapping=true, useidcoordinates=true)</code></pre><pre><code class="language-none">AnnotatedMultipleSequenceAlignment with 549 annotations : 261×64 Named Array{MIToS.MSA.Residue,2}
               Seq ╲ Col │ 10  13  14  15  16  17  …  72  73  74  75  76  77
─────────────────────────┼──────────────────────────────────────────────────
F6TSD5_XENTR/1-66        │  M   E   S   I   A   R  …   P   K   K   K   Q   Q
A0A158NWR3_ATTCE/11-73   │  M   E   P   I   A   H      P   R   -   -   -   -
A0A091D4B4_FUKDA/1-66    │  M   E   S   V   A   R      P   K   K   K   Q   Q
A0A0A0AJQ4_CHAVO/1-31    │  -   -   -   -   -   -      P   K   K   K   Q   Q
K7FIY6_PELSI/3-38        │  -   -   -   -   -   -      P   K   K   K   Q   Q
A0A087V8U7_BALRE/2-35    │  -   -   -   -   -   -      S   K   D   K   C   -
H9G8V5_ANOCA/4-41        │  -   -   -   -   -   -      S   K   D   K   C   -
G1PRL2_MYOLU/3-40        │  -   -   -   -   -   -      V   K   D   H   R   N
G1T6E9_RABIT/1-66        │  M   E   S   V   A   R      P   K   K   K   Q   Q
⋮                           ⋮   ⋮   ⋮   ⋮   ⋮   ⋮  ⋱   ⋮   ⋮   ⋮   ⋮   ⋮   ⋮
A0A0J7KHJ3_LASNI/1-64    │  M   E   S   I   S   H      P   H   G   R   -   -
H3A632_LATCH/4-64        │  -   -   S   I   S   A      P   K   K   K   Q   Q
A0A091RJP3_9GRUI/1-31    │  -   -   -   -   -   -      P   K   K   K   Q   Q
G1MRN1_MELGA/16-53       │  -   -   -   -   -   -      S   K   D   K   C   -
G3H4L8_CRIGR/2-34        │  -   -   -   -   -   -      V   K   E   N   R   -
K7FIY0_PELSI/2-67        │  M   E   S   L   A   R      P   K   K   K   Q   Q
G3SVU7_LOXAF/8-41        │  -   -   -   -   -   -      V   K   D   H   R   -
A0A194RSG1_PAPMA/1-63    │  M   Y   F   V   S   N      -   -   -   -   -   -
H0VMN3_CAVPO/8-41        │  -   -   -   -   -   -  …   V   K   D   H   R   N</code></pre></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p><strong>Generation of sequence and column mappings</strong>   The keyword argument <code>generatemapping</code> of <code>read</code> allows to generate sequence and column mappings for the MSA. <em>Column mapping</em> is the map between of each column on the MSA object and the column number in the file. <em>Sequence mappings</em> will use the start and end coordinates in the sequence ids for enumerate each residue in the sequence if <code>useidcoordinates</code> is <code>true</code>.  </p></div></div><p>You can plot this MSA and other MIToS’ objects using the <a href="https://juliaplots.github.io/">Plots<img src="assets/external-link.png" alt/></a> package. The installation of <em>Plots</em> is described in the <em>Installation</em> section of this site:</p><div><pre><code class="language-julia">using Plots
pyplot() # Best backend for MSA plots
plot(msa)</code></pre></div><p><img src="msa.png" alt/>  </p><p>The <code>Information</code> module of <code>MIToS</code> has functions to calculate measures from the <a href="https://en.wikipedia.org/wiki/Information_theory">Information Theory<img src="assets/external-link.png" alt/></a>, such as Entropy and Mutual Information (MI), on a MSA. In this example, we will estimate covariation between columns of the MSA with a corrected <strong>MI</strong> that use the BLOSUM62 matrix for calculate pseudo frequencies (<code>BLMI</code>).  </p><div><pre><code class="language-julia">using MIToS.Information
ZBLMIp, BLMIp = BLMI(msa)
ZBLMIp # shows ZBLMIp scores</code></pre><pre><code class="language-none">62×62 Named PairwiseListMatrices.PairwiseListMatrix{Float64,false,Array{Float64,1}}
Col1 ╲ Col2 │           13            14  …            75            76
────────────┼──────────────────────────────────────────────────────────
13          │          NaN     0.0370349  …     0.0916213      0.116179
14          │    0.0370349           NaN        0.0585903     -0.129617
15          │   -0.0108716   -0.00452166       -0.0458224     -0.211653
16          │    0.0350124     0.0353959       -0.0627672     -0.246564
17          │    -0.122781     0.0243272         0.136952    -0.0675807
18          │   0.00825441     0.0419882        -0.223201    -0.0825521
19          │   -0.0202234   -0.00174809        -0.287372     -0.160813
20          │    0.0617191    -0.0940622         0.254618      0.107992
21          │    -0.132807    -0.0423731         -0.12707     0.0184265
⋮                        ⋮             ⋮  ⋱             ⋮             ⋮
68          │     0.150368       0.21815       -0.0760483     -0.202901
69          │   0.00870872       0.07542         0.102201      0.198563
70          │     0.118947      0.107757       -0.0721015    -0.0359417
71          │    -0.122288      0.196582        -0.100452    -0.0398799
72          │     0.012368     -0.122815         0.190466      0.237385
73          │     0.114893    0.00519454         0.167814    -0.0354487
74          │   -0.0643496    -0.0242467       -0.0414402    -0.0553935
75          │    0.0916213     0.0585903              NaN    -0.0342573
76          │     0.116179     -0.129617  …    -0.0342573           NaN</code></pre></div><p>Once the <em>Plots</em> package is installed and loaded, you can use its capabilities to visualize this results:</p><div><pre><code class="language-julia">heatmap(ZBLMIp, yflip=true, c=:grays)</code></pre></div><p><img src="blmi.png" alt/>  </p><div></div><h2><a class="nav-anchor" id="commandline-1" href="#commandline-1">MIToS in system command line</a></h2><p>Calculate ZBLMIp on the system shell is easy using the MIToS script called <code>BLMI.jl</code>. This script reads a MSA file, and writes a file with the same base name of the input but with the <code>.BLMI.csv</code> extension.  </p><pre><code class="language-none">BLMI.jl PF14972.stockholm.gz</code></pre><footer><hr/><a class="previous" href="Installation.html"><span class="direction">Previous</span><span class="title">Installation</span></a><a class="next" href="MSA.html"><span class="direction">Next</span><span class="title">MSA</span></a></footer></article></body></html>
