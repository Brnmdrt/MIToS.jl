<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Pfam · MIToS</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MIToS</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="Installation.html">Installation</a></li><li><a class="toctext" href="Example.html">Example</a></li><li><span class="toctext">Modules</span><ul><li><a class="toctext" href="MSA.html">MSA</a></li><li><a class="toctext" href="Information.html">Information</a></li><li><a class="toctext" href="SIFTS.html">SIFTS</a></li><li><a class="toctext" href="PDB.html">PDB</a></li><li class="current"><a class="toctext" href="Pfam.html">Pfam</a><ul class="internal"><li><a class="toctext" href="#Features-1">Features</a></li><li><a class="toctext" href="#Contents-1">Contents</a></li><li><a class="toctext" href="#Getting-a-Pfam-MSA-1">Getting a Pfam MSA</a></li><li><a class="toctext" href="#Getting-PDB-information-from-an-MSA-1">Getting PDB information from an MSA</a></li></ul></li></ul></li><li><a class="toctext" href="Scripts.html">Scripts</a></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="MSA_API.html">MSA</a></li><li><a class="toctext" href="Information_API.html">Information</a></li><li><a class="toctext" href="SIFTS_API.html">SIFTS</a></li><li><a class="toctext" href="PDB_API.html">PDB</a></li><li><a class="toctext" href="Pfam_API.html">Pfam</a></li><li><a class="toctext" href="Utils_API.html">Utils</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Modules</li><li><a href="Pfam.html">Pfam</a></li></ul><a class="edit-page" href="https://github.com/diegozea/MIToS.jl/blob/master/docs/src/Pfam.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Pfam</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Module-Pfam-1" href="#Module-Pfam-1">Pfam</a></h1><p>MIToS defines methods and types useful for any MSA. The <code>Pfam</code> module uses other MIToS modules in the context of Pfam MSAs, where it’s possible to us determine how structure and sequence information should be mapped. This module defines functions that go from a Pfam MSA to the protein contact prediction performance of pairwise scores estimated from that MSA.</p><pre><code class="language-julia">using MIToS.Pfam # to load the Pfam module</code></pre><h2><a class="nav-anchor" id="Features-1" href="#Features-1">Features</a></h2><ul><li><p><a href="Pfam.html#Getting-a-Pfam-MSA-1"><strong>Download and read</strong></a> Pfam MSAs.</p></li><li><p>Obtain <a href="Pfam.html#Getting-PDB-information-from-an-MSA-1"><strong>PDB information</strong></a> from alignment annotations.</p></li><li><p><a href="Pfam.html#Getting-PDB-information-from-an-MSA-1"><strong>Map</strong></a> between sequence/alignment residues/columns and PDB structures.</p></li><li><p>Measure of <a href="Pfam.html#PDB-contacts-and-AUC-1"><strong>AUC</strong></a> (ROC curve) for <a href="Pfam.html#PDB-contacts-and-AUC-1"><strong>protein contact</strong></a> prediction of MI scores.</p></li></ul><h2><a class="nav-anchor" id="Contents-1" href="#Contents-1">Contents</a></h2><ul><li><a href="Pfam.html#Module-Pfam-1">Pfam</a></li><ul><li><a href="Pfam.html#Features-1">Features</a></li><li><a href="Pfam.html#Contents-1">Contents</a></li><li><a href="Pfam.html#Getting-a-Pfam-MSA-1">Getting a Pfam MSA</a></li><li><a href="Pfam.html#Getting-PDB-information-from-an-MSA-1">Getting PDB information from an MSA</a></li><ul><li><a href="Pfam.html#PDB-contacts-and-AUC-1">PDB contacts and AUC</a></li></ul></ul></ul><h2><a class="nav-anchor" id="Getting-a-Pfam-MSA-1" href="#Getting-a-Pfam-MSA-1">Getting a Pfam MSA</a></h2><p>The function <code>downloadpfam</code> takes a Pfam accession and downloads a Pfam MSA in Stockholm format. Use <code>read</code> function and the <code>Stockholm</code> <code>FileFormat</code> to get a <code>AnnotatedMultipleSequenceAlignment</code> object with the MSA and its Pfam annotations. You must set <code>generatemapping</code> and <code>useidcoordinates</code> to <code>true</code> the first time you read the downloaded MSA. This is necessary to some of the methods in the <code>Pfam</code> module.  </p><div><pre><code class="language-julia">using MIToS.Pfam
pfamfile = downloadpfam(&quot;PF12464&quot;)
msa = read(pfamfile, Stockholm, generatemapping=true, useidcoordinates=true)</code></pre><pre><code class="language-none">AnnotatedMultipleSequenceAlignment with 5303 annotations : 2634×53 Named Array{MIToS.MSA.Residue,2}
                 Seq ╲ Col │  19   20   21   22   23  …  152  153  154  155  156
───────────────────────────┼────────────────────────────────────────────────────
C5KKB6_PERM5/11-65         │   R    M    S    S    G  …    F    G    A    C    G
R6YY02_9BACE/7-59          │   -    C    R    L    G       L    G    K    T    G
A0A142EJF7_9BACT/7-58      │   K    M    L    A    G       L    G    K    I    -
R7INL8_9FIRM/6-57          │   R    M    L    A    G       L    G    K    C    G
A0A0Q5MZT3_9MICO/16-67     │   R    M    L    A    G       L    G    -    -    -
A0A0U1M3J6_9EURO/37-101    │   R    M    V    S    G       L    G    G    -    -
H0A616_9PROT/32-83         │   K    M    L    A    G       F    G    E    V    G
G5H9F3_9BACT/1-50          │   -    M    L    A    G       L    P    N    T    -
A0A161Y4T0_9PEZI/31-89     │   K    M    I    S    G       F    G    K    V    G
⋮                              ⋮    ⋮    ⋮    ⋮    ⋮  ⋱    ⋮    ⋮    ⋮    ⋮    ⋮
A0A135S4T6_9PEZI/22-73     │   R    M    R    N    G       -    -    -    -    -
A0A094FF46_9PEZI/28-85     │   R    M    I    S    G       I    G    R    I    G
G4L336_TETHN/9-58          │   K    M    I    A    G       F    G    S    V    G
A0A087APF1_9BIFI/34-85     │   -    M    M    D    G       L    P    H    H    G
I1YX66_PREI7/6-57          │   -    -    -    -    -       L    G    K    T    G
A0A0R2I416_CARDV/7-56      │   K    M    I    A    G       L    G    K    V    G
R7YHZ5_CONA1/28-89         │   R    M    I    S    G       L    G    S    I    -
S9VZL4_SCHCR/21-76         │   K    M    I    Q    G       -    -    -    -    -
A0A0D1A7S7_9LACO/1-49      │   -    M    T    A    G  …    F    A    D    T    G</code></pre></div><h2><a class="nav-anchor" id="Getting-PDB-information-from-an-MSA-1" href="#Getting-PDB-information-from-an-MSA-1">Getting PDB information from an MSA</a></h2><p>The function <code>getseq2pdb</code> parses the MSA annotations to return a <code>Dict</code> from the sequence identifier in the MSA to PDB and chain codes.  </p><div><pre><code class="language-julia">getseq2pdb(msa)</code></pre><pre><code class="language-none">Dict{String,Array{Tuple{String,String},1}} with 5 entries:
  &quot;Q18A66_PEPD6/6-57&quot; =&gt; Tuple{String,String}[(&quot;4ISX&quot;, &quot;A&quot;), (&quot;4ISX&quot;, &quot;B&quot;), (&quot;3…
  &quot;THGA_ECOLI/8-59&quot;   =&gt; Tuple{String,String}[(&quot;1KRR&quot;, &quot;B&quot;), (&quot;1KRU&quot;, &quot;A&quot;), (&quot;1…
  &quot;MAA_ECOLI/7-58&quot;    =&gt; Tuple{String,String}[(&quot;1OCX&quot;, &quot;C&quot;), (&quot;1OCX&quot;, &quot;A&quot;), (&quot;1…
  &quot;Q9KLB0_VIBCH/8-57&quot; =&gt; Tuple{String,String}[(&quot;3NZ2&quot;, &quot;J&quot;), (&quot;3NZ2&quot;, &quot;D&quot;), (&quot;3…
  &quot;Q81N16_BACAN/7-58&quot; =&gt; Tuple{String,String}[(&quot;3IGJ&quot;, &quot;A&quot;), (&quot;3HJJ&quot;, &quot;C&quot;), (&quot;3…</code></pre></div><p>Once you know the association between PDB chains and sequences, you can use that information together with the <code>msacolumn2pdbresidue</code> function to get the PDB residue number that correspond to each MSA column for given a determined sequence and PDB chain. That function downloads information from SIFTS to generate the mapping.  </p><div><pre><code class="language-julia">col2res = msacolumn2pdbresidue(msa, &quot;MAA_ECOLI/7-58&quot;, &quot;1OCX&quot;, &quot;C&quot;)</code></pre><pre><code class="language-none">Dict{Int64,String} with 51 entries:
  68  =&gt; &quot;36&quot;
  148 =&gt; &quot;50&quot;
  124 =&gt; &quot;43&quot;
  46  =&gt; &quot;19&quot;
  25  =&gt; &quot;13&quot;
  55  =&gt; &quot;25&quot;
  151 =&gt; &quot;53&quot;
  29  =&gt; &quot;16&quot;
  58  =&gt; &quot;27&quot;
  59  =&gt; &quot;28&quot;
  155 =&gt; &quot;57&quot;
  150 =&gt; &quot;52&quot;
  95  =&gt; &quot;40&quot;
  57  =&gt; &quot;26&quot;
  20  =&gt; &quot;8&quot;
  31  =&gt; &quot;17&quot;
  70  =&gt; &quot;37&quot;
  52  =&gt; &quot;22&quot;
  96  =&gt; &quot;41&quot;
  ⋮   =&gt; ⋮</code></pre></div><p>The returned dictionary can be used to get the PDB residue associated to each column (using the <code>msaresidues</code> function)...  </p><div><pre><code class="language-julia">using MIToS.PDB
pdbfile = downloadpdb(&quot;1OCX&quot;)
pdb = read(pdbfile, PDBML)
resdict = @residuesdict pdb model &quot;1&quot; chain &quot;C&quot; group &quot;ATOM&quot; residue All

msaresidues(msa, resdict, col2res)</code></pre><pre><code class="language-none">DataStructures.OrderedDict{Int64,MIToS.PDB.PDBResidue} with 51 entries:
  19 =&gt; PDBResidue:…
  20 =&gt; PDBResidue:…
  21 =&gt; PDBResidue:…
  22 =&gt; PDBResidue:…
  23 =&gt; PDBResidue:…
  24 =&gt; PDBResidue:…
  25 =&gt; PDBResidue:…
  26 =&gt; PDBResidue:…
  27 =&gt; PDBResidue:…
  29 =&gt; PDBResidue:…
  31 =&gt; PDBResidue:…
  35 =&gt; PDBResidue:…
  46 =&gt; PDBResidue:…
  50 =&gt; PDBResidue:…
  51 =&gt; PDBResidue:…
  52 =&gt; PDBResidue:…
  53 =&gt; PDBResidue:…
  54 =&gt; PDBResidue:…
  55 =&gt; PDBResidue:…
  ⋮  =&gt; ⋮</code></pre></div><p>...or to delete the columns without PDB residues (using the <code>hasresidues</code> function):  </p><div><pre><code class="language-julia">using MIToS.MSA
filtercolumns!(msa, hasresidues(msa, col2res))</code></pre><pre><code class="language-none">AnnotatedMultipleSequenceAlignment with 5304 annotations : 2634×51 Named Array{MIToS.MSA.Residue,2}
                 Seq ╲ Col │  19   20   21   22   23  …  151  152  153  154  155
───────────────────────────┼────────────────────────────────────────────────────
C5KKB6_PERM5/11-65         │   R    M    S    S    G  …    F    F    G    A    C
R6YY02_9BACE/7-59          │   -    C    R    L    G       L    L    G    K    T
A0A142EJF7_9BACT/7-58      │   K    M    L    A    G       L    L    G    K    I
R7INL8_9FIRM/6-57          │   R    M    L    A    G       I    L    G    K    C
A0A0Q5MZT3_9MICO/16-67     │   R    M    L    A    G       L    L    G    -    -
A0A0U1M3J6_9EURO/37-101    │   R    M    V    S    G       L    L    G    G    -
H0A616_9PROT/32-83         │   K    M    L    A    G       A    F    G    E    V
G5H9F3_9BACT/1-50          │   -    M    L    A    G       L    L    P    N    T
A0A161Y4T0_9PEZI/31-89     │   K    M    I    S    G       L    F    G    K    V
⋮                              ⋮    ⋮    ⋮    ⋮    ⋮  ⋱    ⋮    ⋮    ⋮    ⋮    ⋮
A0A135S4T6_9PEZI/22-73     │   R    M    R    N    G       -    -    -    -    -
A0A094FF46_9PEZI/28-85     │   R    M    I    S    G       L    I    G    R    I
G4L336_TETHN/9-58          │   K    M    I    A    G       T    F    G    S    V
A0A087APF1_9BIFI/34-85     │   -    M    M    D    G       L    L    P    H    H
I1YX66_PREI7/6-57          │   -    -    -    -    -       L    L    G    K    T
A0A0R2I416_CARDV/7-56      │   K    M    I    A    G       L    L    G    K    V
R7YHZ5_CONA1/28-89         │   R    M    I    S    G       I    L    G    S    I
S9VZL4_SCHCR/21-76         │   K    M    I    Q    G       -    -    -    -    -
A0A0D1A7S7_9LACO/1-49      │   -    M    T    A    G  …    L    F    A    D    T</code></pre></div><h3><a class="nav-anchor" id="PDB-contacts-and-AUC-1" href="#PDB-contacts-and-AUC-1">PDB contacts and AUC</a></h3><p>The <code>Dict</code> between MSA columns and PDB residue number also can be used to generate a protein contact map associated to the MSA.  </p><div><pre><code class="language-julia">cmap = msacontacts(msa, resdict, col2res)</code></pre><pre><code class="language-none">51×51 Named PairwiseListMatrices.PairwiseListMatrix{Float64,false,Array{Float64,1}}
Col1 ╲ Col2 │  19   20   21   22   23   24  …  150  151  152  153  154  155
────────────┼──────────────────────────────────────────────────────────────
19          │ NaN  1.0  1.0  1.0  1.0  1.0  …  0.0  0.0  0.0  0.0  0.0  0.0
20          │ 1.0  NaN  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0
21          │ 1.0  1.0  NaN  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0
22          │ 1.0  1.0  1.0  NaN  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0
23          │ 1.0  1.0  1.0  1.0  NaN  1.0     0.0  0.0  0.0  0.0  0.0  0.0
24          │ 1.0  1.0  1.0  1.0  1.0  NaN     0.0  0.0  0.0  0.0  0.0  0.0
25          │ 1.0  1.0  0.0  0.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0
26          │ 1.0  1.0  1.0  0.0  0.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0
27          │ 0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0
⋮               ⋮    ⋮    ⋮    ⋮    ⋮    ⋮  ⋱    ⋮    ⋮    ⋮    ⋮    ⋮    ⋮
147         │ 0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  0.0  0.0  0.0
148         │ 0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  0.0  1.0
149         │ 0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  0.0  1.0
150         │ 0.0  0.0  0.0  0.0  0.0  0.0     NaN  1.0  1.0  0.0  0.0  1.0
151         │ 0.0  0.0  0.0  0.0  0.0  0.0     1.0  NaN  1.0  1.0  0.0  0.0
152         │ 0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  NaN  1.0  1.0  1.0
153         │ 0.0  0.0  0.0  0.0  0.0  0.0     0.0  1.0  1.0  NaN  1.0  1.0
154         │ 0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  1.0  1.0  NaN  1.0
155         │ 0.0  0.0  0.0  0.0  0.0  0.0  …  1.0  0.0  1.0  1.0  1.0  NaN</code></pre></div><p>That protein contact map can be used to calculate the Area Under the ROC Curve for a given score with the <code>AUC</code> function.  </p><div><pre><code class="language-julia">using MIToS.Information
ZMIp, MIp = buslje09(msa)

using ROCAnalysis # You need to load ROCAnalysis to use the AUC function

AUC(ZMIp, cmap)</code></pre><pre><code class="language-none">WARNING: Method definition detplot(ROCAnalysis.Roc{T} where T&lt;:Real) in module ROCAnalysis at /home/travis/.julia/v0.6/ROCAnalysis/src/plot.jl:9 overwritten at /home/travis/.julia/v0.6/ROCAnalysis/src/pyplot.jl:10.
WARNING: Method definition detplot(ROCAnalysis.Roc{T} where T&lt;:Real, Any) in module ROCAnalysis at /home/travis/.julia/v0.6/ROCAnalysis/src/plot.jl:9 overwritten at /home/travis/.julia/v0.6/ROCAnalysis/src/pyplot.jl:10.
WARNING: Method definition #detplot(Array{Any, 1}, typeof(ROCAnalysis.detplot), ROCAnalysis.Roc{T} where T&lt;:Real) in module ROCAnalysis overwritten.
WARNING: Method definition #detplot(Array{Any, 1}, typeof(ROCAnalysis.detplot), ROCAnalysis.Roc{T} where T&lt;:Real, Any) in module ROCAnalysis overwritten.
0.7892098174199341</code></pre></div><footer><hr/><a class="previous" href="PDB.html"><span class="direction">Previous</span><span class="title">PDB</span></a><a class="next" href="Scripts.html"><span class="direction">Next</span><span class="title">Scripts</span></a></footer></article></body></html>
