<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Change B-factors · MIToS</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MIToS</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../Installation/">Installation</a></li><li><a class="toctext" href="../Example/">Example</a></li><li><span class="toctext">Modules</span><ul><li><a class="toctext" href="../MSA/">MSA</a></li><li><a class="toctext" href="../Information/">Information</a></li><li><a class="toctext" href="../SIFTS/">SIFTS</a></li><li><a class="toctext" href="../PDB/">PDB</a></li><li><a class="toctext" href="../Pfam/">Pfam</a></li></ul></li><li><a class="toctext" href="../Scripts/">Scripts</a></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="../MSA_API/">MSA</a></li><li><a class="toctext" href="../Information_API/">Information</a></li><li><a class="toctext" href="../SIFTS_API/">SIFTS</a></li><li><a class="toctext" href="../PDB_API/">PDB</a></li><li><a class="toctext" href="../Pfam_API/">Pfam</a></li><li><a class="toctext" href="../Utils_API/">Utils</a></li></ul></li><li><span class="toctext">Cookbook</span><ul><li class="current"><a class="toctext" href>Change B-factors</a><ul class="internal"><li><a class="toctext" href="#Problem-description-1">Problem description</a></li><li><a class="toctext" href="#MIToS-solution-1">MIToS solution</a></li><li><a class="toctext" href="#Discussion-1">Discussion</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Cookbook</li><li><a href>Change B-factors</a></li></ul><a class="edit-page" href="https://github.com/diegozea/MIToS.jl/blob/master/docs/src/cookbook/01_Change_B_factors.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Change B-factors</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Change-B-factors-1" href="#Change-B-factors-1">Change B-factors</a></h1><p><a href="https://mybinder.org/v2/gh/diegozea/MIToS.jl/gh-pages?filepath=dev/cookbook/notebooks/01_Change_B_factors.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/diegozea/MIToS.jl/blob/gh-pages/dev/cookbook/notebooks/01_Change_B_factors.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><h2><a class="nav-anchor" id="Problem-description-1" href="#Problem-description-1">Problem description</a></h2><p>It is a common practice to change the B-factors of a PDB to store information about atoms or residues to be used by other programs. In particular, values in the B-factor column can be easily used to colour residues with <a href="https://pymolwiki.org/index.php/Color#B-Factors">PyMOL</a> or <a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/bfactor.html">Chimera</a>.</p><p>We cannot simply assign a new value to the <code>B</code> field of a <code>PDBAtom</code> because this type is immutable. However, we can make use of the <code>@set</code> macro of the <a href="https://github.com/jw3126/Setfield.jl">Setfield</a> package to create a new <code>PDBAtom</code> with a different B-factor value.</p><p>In a PDB file, B-factors are stored from the column 61 to 66. Therefore, new B-factors should be a <code>String</code> with 6 or fewer characters, normally using two characters for decimal values. We can use <code>fmt</code> and <code>FormatSpec</code> from the <a href="https://github.com/JuliaIO/Formatting.jl">Formatting</a> package to create a proper B-factor string.</p><h2><a class="nav-anchor" id="MIToS-solution-1" href="#MIToS-solution-1">MIToS solution</a></h2><p>For this example we are going to use the small heat shock protein AgsA from <em>Salmonella typhimurium</em> (PDB code: <em>4ZJ9</em>) available in MIToS docs data:</p><pre><code class="language-julia">using MIToS
pdbfile = abspath(pathof(MIToS), &quot;..&quot;, &quot;..&quot;, &quot;docs&quot;, &quot;data&quot;, &quot;4zj9.pdb&quot;)</code></pre><p>First, we need to read the PDB file using the <code>MIToS.PDB</code> module:</p><pre><code class="language-julia">using MIToS.PDB
pdb_residues = read(pdbfile, PDBFile)</code></pre><p>For this example, we are going to replace the B-factor of the alpha-carbons by the residue hydrophobicity according to the hydrophobicity scale of <a href="https://doi.org/10.1016/0022-2836(82)90515-0">Kyte and Doolittle</a> used by <a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/midas/hydrophob.html">Chimera</a>:</p><pre><code class="language-julia">hydrophobicity = Dict(
	&quot;ILE&quot; =&gt; 4.5,
	&quot;VAL&quot; =&gt; 4.2,
	&quot;LEU&quot; =&gt; 3.8,
	&quot;PHE&quot; =&gt; 2.8,
	&quot;CYS&quot; =&gt; 2.5,
	&quot;MET&quot; =&gt; 1.9,
	&quot;ALA&quot; =&gt; 1.8,
	&quot;GLY&quot; =&gt; -0.4,
	&quot;THR&quot; =&gt; -0.7,
	&quot;SER&quot; =&gt; -0.8,
	&quot;TRP&quot; =&gt; -0.9,
	&quot;TYR&quot; =&gt; -1.3,
	&quot;PRO&quot; =&gt; -1.6,
	&quot;HIS&quot; =&gt; -3.2,
	&quot;GLU&quot; =&gt; -3.5,
	&quot;GLN&quot; =&gt; -3.5,
	&quot;ASP&quot; =&gt; -3.5,
	&quot;ASN&quot; =&gt; -3.5,
	&quot;LYS&quot; =&gt; -3.9,
	&quot;ARG&quot; =&gt; -4.5 )</code></pre><p>First, we define a helper function using <code>Formatting</code> to create a proper B-factor string with the PDB format; 6 characters and 2 digits after the decimal point. The <a href="https://www.wwpdb.org/documentation/file-format-content/format23/sect9.html">PDB format description</a> describe this field as:</p><pre><code class="language-none">COLUMNS      DATA TYPE        FIELD      DEFINITION
------------------------------------------------------
61 - 66      Real(6.2)        tempFactor Temperature factor.</code></pre><pre><code class="language-julia">using Formatting

&quot;Return value as a string with the B factor format described in PDB.&quot;
format_b_factor(value) = fmt(FormatSpec(&quot;6.2f&quot;), value) # e.g. 1.5 -&gt; &quot;  1.50&quot;</code></pre><p>Then, where are using that helper function to define a function that returns a new <code>PDBAtom</code> by changing the <code>B</code> factor field using the <code>Setfield</code> package.</p><pre><code class="language-julia">using Setfield

&quot;Return a new PDBAtom with the B-factor changed to value.&quot;
function change_b_factor(atom::PDBAtom, value)
	b_factor_string = format_b_factor(value)
	b_factor_string = strip(b_factor_string) # e.g. &quot;  1.50&quot; -&gt; &quot;1.50&quot;
	if length(b_factor_string) &gt; 6
		throw(ErrorException(&quot;$b_factor_string has more than 6 characters.&quot;))
	end
	@set atom.B = b_factor_string
end</code></pre><p>Now, we can use the <code>change_b_factor</code> function to change the B-factor of each <code>&quot;CA&quot;</code> atom:</p><pre><code class="language-julia">for res in pdb_residues
	for i in eachindex(res.atoms)
		atom = res.atoms[i]
		if atom.atom == &quot;CA&quot;
			res.atoms[i] = change_b_factor(atom, hydrophobicity[res.id.name])
		end
	end
end</code></pre><p>Finally, we can save the changed residues in a new PDB file.</p><pre><code class="language-julia">write(&quot;4zj9_hydrophobicity.pdb&quot;, pdb_residues, PDBFile)</code></pre><h2><a class="nav-anchor" id="Discussion-1" href="#Discussion-1">Discussion</a></h2><p>While we have focused on changing the B-factor field of a <code>PDBAtom</code>, you can use the same approach to change other fields. However, if you want to change atom coordinates, it is better to use the <code>change_coordinates</code> function from the PDB module of MIToS.</p><p>MIToS atoms and residues generally stores the string present in the input file without surrounding spaces. You can use the <code>Formatting</code> module to create these strings and <code>strip</code> to get rid of the spaces. You can see the <a href="https://www.wwpdb.org/documentation/file-format-content/format23/sect9.html">PDB format description</a> to know what is the format of the expected string or see the <a href="https://github.com/diegozea/MIToS.jl/blob/master/src/PDB/PDBParser.j">MIToS PDB print source code</a> to get a quick idea.</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../Utils_API/"><span class="direction">Previous</span><span class="title">Utils</span></a></footer></article></body></html>
